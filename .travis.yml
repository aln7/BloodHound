language: node_js
node_js:
  - "6"

env:
  matrix:
    secure: GN9gOp3XU0l85QAB+Kk7jiAjTl6Ob/6MlwYX9sbqD1GE3WpN1mWYrlt6hGZeiqvSAyy4dLdGF+jyQNRkRjpEFt4kD/7M8y/7O5oN64o3YqLAdZvfLeGzb12Ore2QN7bK+e7JxmFFQCnxhMXCcHWILnwRBNrNn/3GQbXdBTFw4DvqOnyAI4gc4zQ7FrUDu/D1iNjwwano2jiYmcopbahX66SoFZfQooRY3+1m1gOUshZVlkjet7rl2ocnfQ2le8bd78GYbQ5fuLBNXX2VMZQ2NB9xYUG6N9ch+PPEJXxqqF5Fv4WlqN1u1Ca8xWvCx8MWt6lnoKvMLOF1kaBGapFdrKZenNKIjTzb6fOZgJJPF+0yPe1uobp9KdQFqIyBNtwR9qx5DRMEfezRmjiKXlLHCW7jy5kWUpQ1EcbKElXrNmXNjTUU7jkXszqTCw+XIAWyv3a/lkJqdGwRRJ5pxlK+t3maDolOhBhLSE+JQtW7RnrPlBeMIKNfKsKOW/YMFRQRGWDHk5DXN4TRfwjktZaWMmcF/e4iwNQb7TYDZo/cMRhBhOXEWPVuYb15gPbTDa9iUTpoCGBS5NNsbOTCVYXW7M9uNZjdc1AoTGNS5p4vAHxUk0amMOWY49Fu17zqwGMYKH9JxRf0hsBuLDlU1F8widgtdHpmf7bqamkVQNehFbY=

os:
  - linux
  - osx

before_install:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install p7zip; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get -qq update; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get install -y p7zip-full; fi

install:
  - npm install
  - npm install -g electron-packager

script:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then npm run macbuild; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then npm run linuxbuild; fi

before_deploy:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then 7z a -tzip -mx9 BloodHound-darwin-x64-$TRAVIS_COMMIT.zip BloodHound-darwin-x64 > /dev/null; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then 7z a -tzip -mx9 BloodHound-linux-ia32-$TRAVIS_COMMIT.zip BloodHound-linux-ia32 > /dev/null; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then 7z a -tzip -mx9 BloodHound-linux-x64-$TRAVIS_COMMIT.zip BloodHound-linux-x64 > /dev/null; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then 7z a -tzip -mx9 BloodHound-linux-armv7l-$TRAVIS_COMMIT.zip BloodHound-linux-armv7l > /dev/null; fi

deploy:
  provider: script
  script: /bin/bash deploy.sh
  skip_cleanup: true
  on:
    branch: master

notifications:
  email: false

branches:
  only:
    - master
